<html>
    <head>
        
        </style>
        <head>
            <title>Class work | Home Work | test server change</title>
           
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <script src="tailwindcss.js"></script>
            
                
            </style>
            <script>
                tailwind.config = {
                    theme: {
                        extend: {
                            colors: {
            'elm': {
  DEFAULT: '#1E7B85',
  50: '#7AD7E1',
  100: '#69D2DD',
  200: '#48C8D6',
  300: '#2DB9C8',
  400: '#269AA6',
  500: '#1E7B85',
  600: '#196870',
  700: '#15555B',
  800: '#104147',
  900: '#0B2E32',
  950: '#092427'
},                    
            
            'flamingo': {
                DEFAULT: '#EF4444',
                50: '#FDEDEF',
                100: '#FCDADE',
                200: '#F9B5BA',
                300: '#F58F94',
                400: '#F26A6D',
                500: '#EF4444',
                600: '#EC241E',
                700: '#D01B12',
                800: '#AA1A0F',
                900: '#84170B',
                950: '#72150A'
              },
'silver': {
  DEFAULT: '#C1C1C1',
  50: '#FFFFFF',
   100: '#FFFFFF',
  200: '#FEFEFE',
  300: '#EAEAEA',
  400: '#D5D5D5',
  500: '#C1C1C1',
  600: '#989898',
  700: '#6F6F6F',
  800: '#474747',
  900: '#1E1E1E',
  950: '#090909'
},
'fuchsia-blue': {
  DEFAULT: '#8452BC',
  50: '#D7D7EF',
  100: '#C9C8EA',
  200: '#B2ABDE',
  300: '#9F8DD3',
  400: '#9070C7',
  500: '#8452BC',
  600: '#783FA2',
  700: '#683281',
  800: '#53255F',
  900: '#3B183E',
  950: '#2D122E'
},

}
            }
        }
    }
    </script>
</head>

    <body class="bg-silver-50 flex flex-col text-elm-900 h-svh">
        <div class="bg-flamingo-50 p-8">
            <h1 class="text-elm-500 text-6xl">Header</h1>
        </div>
        <div id='container' class="flex grow flex-column">
          <div class="w-72 box-border p-8 bg-flamingo-100">
            <h1 class="text-elm-400 text-2xl">Sidebar</h1>
        </div>
        <div id='mainBox' class="flex w-full gap-4">
            <div class='bg-silver-500 text-silver-950 p-4 rounded-md shadow-2xl slideDown' style='width:30%;'>
                <form id='ecommerceForm' onsubmit='event.preventDefault();' style='display:flex ;flex-direction:column; gap:4px;'>
                    <label>Checkout Form</label>
                    <input type='text' name='first_name' required id='first_name' placeholder="Enter your first_name"/>
                    <span style='color:red;' hidden id='taskErrorField-first_name' >This field is required</span>
                    <input type='text' name='last_name' required id='last_name' placeholder='Enter your last_name'/>
                    <span style='color:red;' hidden id='taskErrorField-last_name' >This field is required</span>
                    <input type='tel' name='number' required id = 'number' placeholder="Enter your phone_number"/>
                    <span  style='color:red;' hidden id= 'taskErrorField-number'>This field is required</span>
                    <textarea id="address" name="address" placeholder="Enter your full address"></textarea>
                    <span style='color:red;' hidden id ='taskErrorField-address'>This field  is required</span>
                    <input type ='email' name='email' required id='email' placeholder="Enter your email"/>
                    <span style='color:red;' hidden id='taskErrorField-email'>This field is required</span>
                    <input type='text' name='postal_code' required id='postal_code' placeholder="Enter your postal_code"/>
                    <span style='color:red;' hidden id ='taskErrorField-postal_code'>This field is required</span>
                    <select id="city" name="city">
                        <option selected>KARACHI</option>
                        <option selected>ISLAMABAD</option>
                        <option selected>LAHORE</option>
                        <option selected>HYDERABAD</option>
                        <option selected>GURANWALA</option>
                    </select>
                    <span style='color:rgba(255, 0, 0, 0.514);' hidden id ='taskErrorField-city'>This field is required</span>
                    <select id="country" name="country">
                        <option selected>PAKISTAN</option>
                    </select>
                    <span style='color:rgba(255, 0, 0, 0.514);' hidden id ='tasErrorField-country'>This field is required</span>
                    <div>
                        <label class="flex gap-2 elm-700">
                          <input type="radio" name='task' required id ='payment_method' checked placeholder="Enter your payment_method"/>
                           Cash On Delivery
                        </label>
                        <label class="flex gap-2">
                            <input type="radio" name='task' required id ='payment_method' placeholder="Enter your payment_method"/>
                            Online Payment
                            </label>
                        </div>
                        <button type='button' onclick="submitCheckout()" id='submitBtn' class='bg-elm-600 text-silver-200 p-2 border-0 hover:bg-elm-700 active:bg-elm-700 rounded-md'>Checkout</button>
                </form>
                <div>
                    <label>Cart Details</label>
                    <div id="boxlist" style="width: 80%; display: flex; flex-direction: column; gap: 4px;" class=" bg-elm-600 slideDown">

                    </div>
                </div>
         </div>
                <div id='main' class="p-4 grid grow border-box bg-silver-400 gap-4 ">

            </div>
        </div>
    </body>
    <script>
       var initialCheckoutForm = {
            first_name:'',
            last_name:'',
            phone_number:0,
            address:'',
            email:'',
            postal_code:'',
            city:'',
            country:'',
            payment_method:'',
            shipping_details: {
                address:'',
                city:'',
                postal_code:'',
                country:'',
                phone_number: '',
                reciever_name: '',
        },
        total_amount:'',
        cart_details: [],
    }

        var checkoutForm = {
            first_name:'',
            last_name:'',
            phone_number:0,
            address:'',
            email:'',
            postal_code:'',
            city:'',
            country:'',
            payment_method:'',
            shipping_details: {
                address:'',
                city:'',
                postal_code:'',
                country:'',
                phone_number: '',
                reciever_name: '',
        },
        total_amount:'',
        cart_details: [],
    }

    var products = [
        {
            id: 1,
            name: 'water bottle',
            description: 'color:blue size: large',
            price: 100,
            discounted_price: 99,
        },
        {
            id: 2,
            name: 'mouse',
            description: 'wired usb port',
            price: 250,
            discounted_price: 199,

        },
        {
            id: 3,
            name: 'watch',
            description: 'color:black, watch type:smart, brand:apple',
            price: 5000,
            discounted_price: 4999,

        },
        {
            id: 4,
            name: 'infinix s23',
            description: 'color:blue,storage: 120gb ram: 2gb display: 6x4',
            price: 25000,
            discounted_price: 24999,
 
        },
        {
            id: 5,
            name: 'shoes',
            description: 'size: 8, color: blue, type: sports wear',
            price: 3000,
            discounted_price: 3000,
 
        },
    ];

    renderProducts();

    function validateFields() {
        var basicFields= [
            'first_name',
            'last_name',
            'address',
            'postal_code'
        ]
        const basicValidation = () => {
                 var checkValidation = true;
                basicFields.forEach((x)=> {
                     if(document.getElementById(x).value == '' || document.getElementById(x).value == null) {
                         checkValidation = false;

                        document.getElementById('taskErrorField-'+x).hidden = false
                    } else{
                        document.getElementById('taskErrorField-'+x).hidden = true
                    }
                 })
                return checkValidation
             }

      

        var testBasicValidation = basicValidation();
        if(!testBasicValidation) {
            return false

        }

        const validatePhoneNumber = (phoneNumber) => {
            const regx = /^(\+92|92|033|03)[ -]*\d{3}[ -]*\d{7}$/;
             return regx.test(phoneNumber);
        } 
        

         if (!validatePhoneNumber(document.getElementById('number').value)) {
            document.getElementById('taskErrorField-number').hidden = false
            return false
         } else {
            document.getElementById('taskErrorField-number').hidden = true
         }

         const validateEmail = (email) => {
            const regx = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
            return regx.test(email);
         }

         if(!validateEmail(document.getElementById('email').value)) {
            document.getElementById('taskErrorField-email').hidden = false;
             return false;
         } else {
            document.getElementById('taskErrorField-email').hidden = true;
         }


         if(checkoutForm.cart_details.length == 0) {
            alert("Please add items in your cart first");
            return false
         }  

         return true
    

        
        
        

    }

    function submitCheckout() {
        debugger;
       const checkForm = validateFields();
       if(checkForm) {
        alert("Thankyou for Shopping with us");
        checkoutForm = initialCheckoutForm;
        document.getElementById('ecommerceForm').reset();
        renderCarts();
       }
    }



  
    function addToCart(product) {
        debugger;
        var currentProduct = products.find((x) => { return x.id == product});
        var currentQty = document.getElementById('qty'+product).value == '' || document.getElementById('qty'+product).value == null ? 1: document.getElementById('qty'+product).value;
        cartExistIndex = checkoutForm.cart_details.findIndex((x) => { return x.id == product} );
        if(cartExistIndex != -1) {
            checkoutForm.cart_details[cartExistIndex].quantity += parseInt(currentQty);
        } else {
            var cartItem = {
                ...currentProduct,
                quantity: currentQty,
            }

            checkoutForm.cart_details.push(cartItem);
        }
        document.getElementById('qty'+product).value = '';
        renderCarts();
    }


    function removeItemCart(id) {
        debugger;
        var proIndex = checkoutForm.cart_details.findIndex((x) => {return x.id == id});
        checkoutForm.cart_details.splice(proIndex,1);

        renderCarts();
    }
    
    function calculateTotalAmount() {
        let total = 0;
        checkoutForm.cart_details.forEach(item => {
            total += item.discounted_price * item.quantity;
        });
        return total;
    }

    function renderCarts() {
        let cartHtml = '';
        var cartDiv = document.getElementById('boxlist');


        checkoutForm.cart_details.forEach((x) => {
            var priceBox = x.discounted_price < x.price ? `<div class='actual-price'>
                    <span class='discount-price'> `+x.price+`</span>
                    `+x.discounted_price+`
                </div>` : `<div class='actual-price'>
                    `+x.price+`
                </div>` ;


                 cartHtml += `<div class="box" style="background-color:aqua;">
                    <div style="padding-left:10px; border-radius: 50%; padding-right:10px; display:flex; justify-content:space-between; align-items:centre;">
                        <p>`+ x.name +`</p>
                        `+ priceBox +`
                        <div>
                            Quantity `+ x.quantity +`
                            </div>
                            <div>
                                <button onclick="removeItemCart(`+ x.id +`)">
                                    X
                                    </button>
                                </div>
                            </div>
                      </div>`;

            let totalAmount = calculateTotalAmount();
            cartHtml+= `<div style="padding:10px; font-weight:bold;">
                <h3>Total Amount: `+ totalAmount+`</h3>
                </div>`;
        })
        cartDiv.innerHTML = cartHtml;
    }

    function renderProducts() {
       let productHtml = '';
       var productDiv = document.getElementById('main');


       products.forEach((x) => {
       var priceBox = x.discounted_price < x.price ? `<div class = 'text-flamingo-500'>
        <span class='text-elm-600 line-through'> `+x.price+ `</span>
        `+x.discounted_price+`
        </div>` : `<div class='actual-price'>
            `+x.price+`
            </div>` ;
            productHtml += `<div class='bg-silver-500 text-silver-900 p-4 rounded-md shadow-2xl slideDown'>
                    <h1 class='font-bold'>`+ x.name + `</h1>
                    <p class='font-medium'>`+ x.description + `</p>
                    `+ priceBox + `
                    <div class=''>
                        <input type='number' id='qty`+ x.id + `'/>
                        <button class='bg-fuchsiablue-400 text-silver-200 font-medium rounded-lg w-32 py-1' onclick='addToCart(`+ x.id + `)'>Add to Cart</button>

                    </div>
                </div>`;
        });
        productDiv.innerHTML = productHtml;
    }

        
    
    </script>
 </html>

